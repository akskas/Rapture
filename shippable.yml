#Build environment
build_environment: Ubuntu 14.04

#set your language below
language: java

#set language version. This is only required if you use the default Shippable image for your build
jdk:
  - oraclejdk8

build:
  pre_ci_boot:
    image_name: drydock/u14jav
    image_tag: prod
    pull: true
    options: "-e HOME=/root"
  ci:
    - mkdir -p shippable/testresults
    - cd Libs/
    - ./gradlew clean genAll install
    - cmd="{ ./gradlew test } || { echo 'this shit works'}"
    - exec_cmd=$cmd
    - cat /root/src/github.com/akskas/Rapture/Libs/RaptureCore/build/reports/tests/index.html
    - cd ../Apps
    - ./gradlew clean installDist -x test
    - ./gradlew test
  on_success:
    - echo "success"
  on_failure:
    - echo "failure"
    
  cache: false

integrations:
    hub:
        - integrationName: dockerHub
          type: docker
          branches:
            only:
              - master
